<!DOCTYPE html>
<html>
  <head>
    <title>Storefront SDK Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      button {
        padding: 10px 20px;
        margin: 10px 0;
        cursor: pointer;
      }
      #result {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        background-color: #f9f9f9;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <h1>Storefront SDK Test</h1>

    <div>
      <label for="apiKey">API Key:</label>
      <input
        type="text"
        id="apiKey"
        style="width: 300px"
        placeholder="Enter your API key"
        value=""
      />
    </div>

    <div>
      <label for="skuId">SKU ID:</label>
      <input
        type="text"
        id="skuId"
        style="width: 300px"
        value=""
        placeholder="Enter SKU ID"
      />
    </div>

    <div>
      <label for="userReferenceId">User Reference ID:</label>
      <input
        type="text"
        id="userReferenceId"
        style="width: 300px"
        placeholder="Enter user reference ID"
      />
    </div>

    <button onclick="getSku()">Get SKU Details</button>
    <button onclick="purchaseSku()">Purchase SKU</button>

    <div id="result"></div>

    <script
      src="https://storage.googleapis.com/gameshift/storefront.js"
      crossorigin="anonymous"
    ></script>

    <script>
      window.addEventListener('load', () => {
        if (typeof Storefront !== 'undefined') {
          console.log('Storefront SDK loaded successfully');
          document.getElementById('result').textContent = 'SDK Ready';
        } else {
          console.error('Storefront SDK failed to load');
          document.getElementById('result').textContent = 'SDK Failed to Load';
        }
      });

      let storefront;

      function initializeStorefront() {
        const apiKey = document.getElementById('apiKey').value;
        if (!apiKey) {
          alert('Please enter an API key');
          return null;
        }
        return new Storefront({
          apiKey: apiKey,
          environment: Environment.Development,
        });
      }

      async function getSku() {
        storefront = initializeStorefront();
        if (!storefront) return;

        const skuId = document.getElementById('skuId').value;
        if (!skuId) {
          alert('Please enter a SKU ID');
          return;
        }

        try {
          const result = await storefront.getSku(skuId);
          document.getElementById('result').textContent = JSON.stringify(
            result,
            null,
            2,
          );
        } catch (error) {
          document.getElementById('result').textContent =
            'Error: ' + error.message;
        }
      }

      async function purchaseSku() {
        storefront = initializeStorefront();
        if (!storefront) return;

        const skuId = document.getElementById('skuId').value;
        const userReferenceId =
          document.getElementById('userReferenceId').value;

        if (!skuId || !userReferenceId) {
          alert('Please enter both SKU ID and User Reference ID');
          return;
        }

        try {
          const result = await storefront.purchaseSkuImmediately({
            type: 'NewMintUniqueAsset',
            skuId: skuId,
            userReferenceId: userReferenceId,
            quantity: 1,
          });
          document.getElementById('result').textContent = JSON.stringify(
            result,
            null,
            2,
          );
        } catch (error) {
          document.getElementById('result').textContent =
            'Error: ' + error.message;
        }
      }
    </script>
  </body>
</html>
